---
id: 223
title: 'sed #2'
author: Nicolas Ledez
layout: post
guid: http://blog.ledez.net/?p=223
permalink: /informatique/tips/sed-2/
categories:
  - Tips
tags:
  - howto
  - regexp
  - script
  - sed
  - tips
---
Comment utiliser sed pour remplacer √ßa / Howto replace this with sed:

<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;">
  <div class="bash codecolorer">
    ns01:x:<span class="nu0">11062</span>:<span class="nu0">11062</span>::<span class="sy0">/</span>home<span class="sy0">/</span>ns01:<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">sh</span><br /> :x:<span class="nu0">11062</span>:<span class="nu0">11062</span>::<span class="sy0">/</span>home<span class="sy0">/</span>ns01:<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">sh</span>
  </div>
</div>

En √ßa / To this:

<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;">
  <div class="bash codecolorer">
    ns01:x:<span class="nu0">11062</span>:<span class="nu0">11062</span>:::<span class="nu0"></span>:<span class="nu0"></span><br /> :x:<span class="nu0">11062</span>:<span class="nu0">11062</span>:d::<span class="nu0"></span>:<span class="nu0"></span>
  </div>
</div>

Taper les lignes de codes / use there command line:

<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;">
  <div class="bash codecolorer">
    <span class="br0">&#40;</span><span class="kw3">echo</span> ns01:x:<span class="nu0">11062</span>:<span class="nu0">11062</span>::<span class="sy0">/</span>home<span class="sy0">/</span>ns01:<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">sh</span>; \<br /> <span class="kw3">echo</span> :x:<span class="nu0">11062</span>:<span class="nu0">11062</span>:d:<span class="sy0">/</span>home<span class="sy0">/</span>ns01:<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">sh</span> <span class="br0">&#41;</span> \<br /> <span class="sy0">|</span> <span class="kw2">sed</span> <span class="re5">-r</span> <span class="st_h">'s/^(([^:]*:){5}).*/\1:0:0/'</span>
  </div>
</div>

Explications :  
s/ pour lancer la recherche  
-r pour passer en expression r√©guli√®re avanc√©e  
^ pour commencer en d√©but de chaine  
[^:]*: pour chercher tout ce qu&rsquo;il peut y avoir avant un &laquo;&nbsp;:&nbsp;&raquo; y compris rien  
grouper [^:]*: entre des () suivit de {5} pour avoir 5 occurrences du pattern  
le .*$ √† la fin de la chaine pour l&rsquo;enlever dans la substitution

/ pour passer √† la partie de ce qu&rsquo;il faut mettre √† la place  
\1 pour r√©cup√©rer, la premi√®re partie qui match entre ()  
Dans l&rsquo;exemple

<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;">
  <div class="text codecolorer">
    ns01:x:11062:11062::<br /> :x:11062:11062:d:
  </div>
</div>

et :0:0 pour l&rsquo;ajouter √† la fin de la chaine üòâ

Explanation:  
s/ start the search  
-r use extended regular expressions  
^ start on the strings beginning  
[^:]*: search anything excluding &laquo;&nbsp;:&nbsp;&raquo; including nothing  
group [^:]*: in () followed by {5} to have 5 instance of pattern  
the .*$ at the end was here to remove the rest

/ to pass at the remplacement  
\1 to get first matching part was betwen ()  
In this exemple

<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;">
  <div class="bash codecolorer">
    ns01:x:<span class="nu0">11062</span>:<span class="nu0">11062</span>::<br /> :x:<span class="nu0">11062</span>:<span class="nu0">11062</span>:d:
  </div>
</div>

and :0:0 for add it at the end üòâ

Maintenant, vous pouvez utiliser la commande sed / now you can use the sed command:

<div class="codecolorer-container bash default" style="overflow:auto;white-space:nowrap;">
  <div class="bash codecolorer">
    <span class="kw2">sed</span> <span class="re5">-r</span> <span class="st_h">'s/^(([^:]*:){5}).*/\1:0:0/'</span> <span class="sy0">/</span>etc<span class="sy0">/</span><span class="kw2">passwd</span>
  </div>
</div>